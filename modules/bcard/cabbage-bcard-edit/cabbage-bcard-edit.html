<link rel="import" href="../../../bower_components/polymer/polymer.html">

<polymer-element name="cabbage-bcard-edit" attributes="">
	<template>

		<core-ajax  id="updateBCard"
					url="http://127.0.0.1:3000/bcard"
					method="POST"
					handleAs="json"
					contentType="application/x-www-form-urlencoded"
					on-core-response="{{ onBCardUpdateResponse }}"
					on-core-error="{{ onBCardUpdateError }}"></core-ajax>

		<div id="wrapper" vertical layout center>
			<core-image preload fade fullbleed sizing="cover" src="{{ newImage }}"></core-image>
			<div id="input-wrapper">
				<paper-input id="image" value="{{ newImage }}" label="Image"></paper-input>
				<paper-input id="name" label="Name"></paper-input>
				<paper-input id="address" label="Address"></paper-input>
				<paper-input id="phone" label="Phone number"></paper-input>
				<paper-input id="email" label="Email"></paper-input>
			</div>
			<paper-fab icon="done" on-click="{{ onUpdateButtonClick }}" style="background-color: #4CAF50"></paper-fab>
		</div>
		<style>
			:host {
				display: block;
			}
			#wrapper {
				background-color: #eee;
				margin: 50px auto 20px auto;
				width: 70%;
				font-size: 18px;
				font-weight: 200;
				line-height: 30px;
				background-color: #eee;
				border-radius: 6px;
				padding: 30px;
				padding-bottom: 60px;
				position: relative;
			}
			core-image {
				background-color: #727272;
				width: 100%;
				height: 200px;
			}
			paper-fab {
				position: absolute;
				bottom: 0px; right: 0px;
				margin-bottom: 10px;
				margin-right: 10px;
			}
			paper-input { 
				display: block; 
				width: 100%;
			}
			#input-wrapper {
				margin-bottom: 35px;
				width: 100%;	
			}
			paper-input /deep/ .focused-underline {
				background-color: #FBC02D;
			}
		</style>
	</template>
	<script>
		(function () {
			Polymer({
				ready: function() {
					this.appId = CabbageConf.applicationId;
					this.newImage = '';
				},
				getData: function() {
					return {
						'name': this.$.name.value,
						'address': this.$.address.value,
						'email': this.$.email.value,
						'number': this.$.phone.value,
						'image': this.$.image.value
					};
				},
				onUpdateButtonClick: function() {
					MoreRouting.navigateTo('b-card');
					// this.$.updateBCard.params = this.getData();
					// this.$.updateBCard.go();
				},
				onBCardUpdateResponse: function() {
					MoreRouting.navigateTo('b-card');
				},
				onBCardUpdateError: function() {
					console.error('bcard-update | update error');
				}
			});
		})();
	</script>
</polymer-element>
